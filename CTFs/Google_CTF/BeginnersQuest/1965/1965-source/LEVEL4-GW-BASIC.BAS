010 PRINT "*** THE FLAG VERIFICATOR: LEVEL 4 ***"
020 PRINT "VERSION FOR MICROSOFT GW-BASIC 1983"
030 PRINT "FLAG FORMAT: FLAG{[A-Z0-9_!]*}"
035 OPTION BASE 1
040 LET PREFIX=5
050 LET FL=60
060 LET SL=12
070 DIM S(SL)
080 DIM F(FL)
090 FOR I=1 TO SL
100 READ S(I)
105 NEXT I
110 U$=""
120 PRINT "FLAG"; : INPUT U$
140 IF LEN(U$)<>PREFIX+FL+1 THEN GOTO 600
150 FOR J=1 TO FL
160 READ F(J)
170 NEXT J
400 FOR I=1 TO INT(FL/SL)
410 FOR J=1 TO SL
420 K=SL*(I-1)+J
430 Z=S(J) XOR ASC(MID$(U$,K+PREFIX,1))
440 IF Z<>F(K) THEN GOTO 600
450 NEXT J
460 NEXT I
500 PRINT "GOOD JOB! NOW SUBMIT THE FLAG." : END
600 RESTORE
610 PRINT "THE PROVIDED FLAG IS INVALID TRY ANONTHER" : GOTO 90
900 DATA 72,69,76,76,79,71,89,78,86,65,69,76
905 REM *** ENCRYPTED DATA ***
910 DATA 24,0,30,10,10,4,13,17,5,4,6,30
920 DATA 13,6,21,19,24,14,13,6,9,4,29,15
930 DATA 4,16,31,5,25,2,6,10,31,18,15,25
940 DATA 6,6,24,5,0,9,6,15,24,5,26,3
950 DATA 6,0,19,24,6,10,28,17,6,0,1,109
